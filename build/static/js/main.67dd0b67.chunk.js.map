{"version":3,"sources":["../../../src/index.ts","index.ts","../../../src/event-emitter.ts","../../../src/raw.ts","../../../src/utils.ts"],"names":["appApi","initApi","title","version","packageJson","appSignature","DEVELOPMENT_APP_SIGNATURE","button","text","tooltip","requiredEvents","requiredCommands","RequiredCommands","openWindow","document","querySelectorAll","forEach","el","addEventListener","ev","preventDefault","stopPropagation","commands","href"],"mappings":"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","file":"static/js/main.67dd0b67.chunk.js","sourcesContent":["\"use strict\";\n/*\n * Copyright 2019-present Acrolinx GmbH\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, softwareq\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar event_emitter_1 = require(\"./event-emitter\");\nvar raw_1 = require(\"./raw\");\nvar utils_1 = require(\"./utils\");\n/**\n * @public\n */\nexports.DEVELOPMENT_APP_SIGNATURE = 'eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJuYW1lIjoiS2lsbGVyIEFwcCIsImlkIjoiNGVlZDM3NjctMGYzMS00ZDVmLWI2MjktYzg2MWFiM2VkODUyIiwidHlwZSI6IkFQUCIsImlhdCI6MTU2MTE4ODI5M30.zlVJuGITMjAJ2p4nl-qtpj4N0p_8e4tenr-4dkrGdXg';\n/**\n * @public\n */\nvar RequiredCommands;\n(function (RequiredCommands) {\n    RequiredCommands[\"selectRanges\"] = \"selectRanges\";\n    RequiredCommands[\"replaceRanges\"] = \"replaceRanges\";\n    RequiredCommands[\"openWindow\"] = \"openWindow\";\n    RequiredCommands[\"getAppAccessToken\"] = \"getAppAccessToken\";\n})(RequiredCommands = exports.RequiredCommands || (exports.RequiredCommands = {}));\n/**\n * @public\n */\nvar RequiredEvents;\n(function (RequiredEvents) {\n    RequiredEvents[\"textExtracted\"] = \"textExtracted\";\n    RequiredEvents[\"textExtractedLink\"] = \"textExtractedLink\";\n    RequiredEvents[\"invalidRanges\"] = \"invalidRanges\";\n    /**\n     * Experimental.\n     * Since Acrolinx 2020.4\n     */\n    RequiredEvents[\"visibility\"] = \"visibility\";\n    /**\n     * Experimental.\n     * Since Acrolinx 2020.4\n     */\n    RequiredEvents[\"capabilities\"] = \"capabilities\";\n    /**\n     * Since Acrolinx 2021.2\n     * Currently triggered only by regular checks.\n     */\n    RequiredEvents[\"documentChange\"] = \"documentChange\";\n})(RequiredEvents = exports.RequiredEvents || (exports.RequiredEvents = {}));\n/**\n * @internal\n */\nvar DEFAULT_CONFIG = {\n    appSignature: exports.DEVELOPMENT_APP_SIGNATURE,\n    title: 'Acrolinx App',\n    requiredReportContent: [],\n    requiredReportLinks: [],\n};\n/**\n * @internal\n */\nvar AppApiConnection = /** @class */ (function () {\n    function AppApiConnection(config) {\n        var _this = this;\n        this._events = {\n            textExtracted: new event_emitter_1.InternalEventEmitter(),\n            textExtractedLink: new event_emitter_1.InternalEventEmitter(),\n            invalidRanges: new event_emitter_1.InternalEventEmitter(),\n            visibility: new event_emitter_1.InternalEventEmitter(),\n            documentChange: new event_emitter_1.InternalEventEmitter(),\n            capabilities: new event_emitter_1.InternalEventEmitter(),\n        };\n        this.waitingAppAccessTokenResolvers = [];\n        this._commands = {\n            selectRanges: raw_1.selectRanges,\n            replaceRanges: raw_1.replaceRanges,\n            openWindow: raw_1.openWindow,\n            getAppAccessToken: function () { return _this.getAppAccessToken(); },\n        };\n        var requiredReportLinks = [];\n        if (utils_1.includes(config.requiredEvents, RequiredEvents.textExtractedLink)) {\n            requiredReportLinks.push(raw_1.ReportType.extractedText);\n        }\n        var requiredReportContent = [];\n        if (utils_1.includes(config.requiredEvents, RequiredEvents.textExtracted)) {\n            requiredReportContent.push(raw_1.ReportType.extractedText);\n        }\n        raw_1.configureAddon(__assign(__assign(__assign({}, DEFAULT_CONFIG), config), { requiredReportLinks: requiredReportLinks,\n            requiredReportContent: requiredReportContent, requires: config.requiredCommands, requiredEvents: {\n                visibility: utils_1.getEmptyObjectIfIncluded(config.requiredEvents, RequiredEvents.visibility),\n                capabilities: utils_1.getEmptyObjectIfIncluded(config.requiredEvents, RequiredEvents.capabilities),\n                documentChange: utils_1.getEmptyObjectIfIncluded(config.requiredEvents, RequiredEvents.documentChange),\n            } }));\n        window.addEventListener('message', function (messageEvent) {\n            var eventForApp = messageEvent.data;\n            if (messageEvent.source !== window.parent || !(eventForApp === null || eventForApp === void 0 ? void 0 : eventForApp.type)) {\n                // Message is probably not from the Sidebar. Ignore it.\n                return;\n            }\n            console.log('Got message from sidebar', messageEvent.data.type, messageEvent);\n            switch (eventForApp.type) {\n                case 'analysisResult':\n                    _this.handleAnalysisResultEvent(eventForApp);\n                    break;\n                case 'invalidRanges':\n                    _this._events.invalidRanges.dispatchEvent(eventForApp);\n                    break;\n                case 'appAccessToken':\n                    _this.waitingAppAccessTokenResolvers.forEach(function (resolve) {\n                        resolve(eventForApp);\n                    });\n                    _this.waitingAppAccessTokenResolvers = [];\n                    break;\n                case 'visibility':\n                    _this._events.visibility.dispatchEvent(eventForApp);\n                    break;\n                case 'capabilities':\n                    _this._events.capabilities.dispatchEvent(eventForApp);\n                    break;\n                case 'documentChange':\n                    _this._events.documentChange.dispatchEvent(eventForApp);\n                    break;\n                default:\n                    utils_1.exhaustiveSwitchCheck(eventForApp, 'AppApiEvent');\n            }\n        }, false);\n    }\n    Object.defineProperty(AppApiConnection.prototype, \"events\", {\n        get: function () {\n            return this._events;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(AppApiConnection.prototype, \"commands\", {\n        get: function () {\n            return this._commands;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    AppApiConnection.prototype.handleAnalysisResultEvent = function (analysisResult) {\n        var reports = analysisResult.reports;\n        var textExtractedReport = reports[raw_1.ReportType.extractedText] || {};\n        if (textExtractedReport.url) {\n            this._events.textExtractedLink.dispatchEvent({\n                url: textExtractedReport.url,\n                languageId: analysisResult.languageId,\n            });\n        }\n        if (typeof textExtractedReport.content === 'string') {\n            this._events.textExtracted.dispatchEvent({\n                text: textExtractedReport.content,\n                languageId: analysisResult.languageId,\n                selection: analysisResult.selection,\n                document: analysisResult.document,\n            });\n        }\n    };\n    AppApiConnection.prototype.getAppAccessToken = function () {\n        var _this = this;\n        var promise = new Promise(function (resolve) {\n            _this.waitingAppAccessTokenResolvers.push(resolve);\n        });\n        raw_1.getAppAccessToken();\n        return promise;\n    };\n    return AppApiConnection;\n}());\n/**\n * @public\n */\nfunction initApi(conf) {\n    return new AppApiConnection(conf);\n}\nexports.initApi = initApi;\n/**\n * @public\n */\nfunction isInvalid(event, range) {\n    return event.ranges.some(function (inValidRange) {\n        return utils_1.isOverlapping(inValidRange, range);\n    });\n}\nexports.isInvalid = isInvalid;\n//# sourceMappingURL=index.js.map","/*\n * Copyright 2021-present Acrolinx GmbH\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, softwareq\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {DEVELOPMENT_APP_SIGNATURE, initApi, RequiredCommands} from '@acrolinx/app-sdk';\nimport packageJson from '../package.json';\nimport './index.css';\n\nconst appApi = initApi({\n  title: 'Select Ranges',\n  version: packageJson.version,\n  appSignature: DEVELOPMENT_APP_SIGNATURE,\n\n  button: {\n    text: 'Extract Text',\n    tooltip: 'Extract text and select words in the document'\n  },\n\n  requiredEvents: [],\n  requiredCommands: [RequiredCommands.openWindow]\n});\n\n\nfunction startApp() {\n  let linkElements = document.querySelectorAll('a')!;\n  linkElements.forEach((el) => {\n    el.addEventListener(('click'), (ev) => {\n      ev.preventDefault();\n      ev.stopPropagation();\n      appApi.commands.openWindow(el.href);\n    });\n  })\n}\n\nstartApp();\n","\"use strict\";\n/*\n * Copyright 2019-present Acrolinx GmbH\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, softwareq\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\n/**\n * @internal\n */\nvar InternalEventEmitter = /** @class */ (function () {\n    function InternalEventEmitter() {\n        this.listener = [];\n    }\n    InternalEventEmitter.prototype.addEventListener = function (listener) {\n        this.listener.push(listener);\n    };\n    InternalEventEmitter.prototype.removeEventListener = function (listener) {\n        this.listener = this.listener.filter(function (li) { return li !== listener; });\n    };\n    InternalEventEmitter.prototype.dispatchEvent = function (event) {\n        this.listener.forEach(function (listener) {\n            listener(event);\n        });\n    };\n    return InternalEventEmitter;\n}());\nexports.InternalEventEmitter = InternalEventEmitter;\n//# sourceMappingURL=event-emitter.js.map","\"use strict\";\n/*\n * Copyright 2019-present Acrolinx GmbH\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, softwareq\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar ReportType;\n(function (ReportType) {\n    ReportType[\"extractedText\"] = \"extractedText\";\n})(ReportType = exports.ReportType || (exports.ReportType = {}));\nvar RequiredAppApiCommand;\n(function (RequiredAppApiCommand) {\n    RequiredAppApiCommand[\"selectRanges\"] = \"selectRanges\";\n    RequiredAppApiCommand[\"replaceRanges\"] = \"replaceRanges\";\n})(RequiredAppApiCommand = exports.RequiredAppApiCommand || (exports.RequiredAppApiCommand = {}));\nfunction hasParentWindow() {\n    return window.parent && window.parent !== window;\n}\nexports.hasParentWindow = hasParentWindow;\nfunction openWindow(url) {\n    if (hasParentWindow()) {\n        postMessageToSidebar({ command: 'acrolinx.sidebar.openWindow', url: url });\n    }\n    else {\n        window.open(url);\n    }\n}\nexports.openWindow = openWindow;\nfunction selectRanges(ranges) {\n    postMessageToSidebar({ command: 'acrolinx.sidebar.selectRanges', ranges: ranges });\n}\nexports.selectRanges = selectRanges;\nfunction replaceRanges(ranges) {\n    postMessageToSidebar({ command: 'acrolinx.sidebar.replaceRanges', ranges: ranges });\n}\nexports.replaceRanges = replaceRanges;\nfunction configureAddon(config) {\n    postMessageToSidebar({ command: 'acrolinx.sidebar.configureAddon', config: config });\n}\nexports.configureAddon = configureAddon;\nfunction getAppAccessToken() {\n    postMessageToSidebar({ command: 'acrolinx.sidebar.requestAppAccessToken' });\n}\nexports.getAppAccessToken = getAppAccessToken;\nfunction requestCapabilities() {\n    postMessageToSidebar({ command: 'acrolinx.sidebar.requestCapabilities' });\n}\nexports.requestCapabilities = requestCapabilities;\nfunction postMessageToSidebar(message) {\n    if (hasParentWindow()) {\n        window.parent.postMessage(message, '*');\n    }\n    else {\n        console.warn('Missing parent window with sidebar.', message);\n    }\n}\n//# sourceMappingURL=raw.js.map","\"use strict\";\n/** @internal Make all the code in this file (Dynamic Module) external */\n/**\n * Copyright 2019-present Acrolinx GmbH\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, softwareq\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n *\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\n/**\n * @packageDocumentation\n * @internal\n */\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nfunction includes(array, element) {\n    if (!array) {\n        return false;\n    }\n    return array.indexOf(element) >= 0;\n}\nexports.includes = includes;\nfunction getEmptyObjectIfIncluded(array, element) {\n    return includes(array, element) ? {} : undefined;\n}\nexports.getEmptyObjectIfIncluded = getEmptyObjectIfIncluded;\nfunction isOverlapping(range1, range2) {\n    var isNotOverlapping = range2.begin >= range1.end || range2.end <= range1.begin;\n    return !isNotOverlapping;\n}\nexports.isOverlapping = isOverlapping;\nfunction exhaustiveSwitchCheck(param, name) {\n    throw new Error(\"Can't handle \" + name + \" with value \" + JSON.stringify(param));\n}\nexports.exhaustiveSwitchCheck = exhaustiveSwitchCheck;\n//# sourceMappingURL=utils.js.map"],"sourceRoot":""}